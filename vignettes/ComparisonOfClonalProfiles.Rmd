---
title: "Comparison of clonal profiles"
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

##  Load data

We load the scRNA data of HNSCC26 Primary and HNSCC26 Lymph Node sample from the public dataset of Head&Neck cancer (GSE10332)

```{r echo=TRUE, message=FALSE, warning=FALSE}
load(url("https://github.com/AntonioDeFalco/SCEVAN/raw/main/data/HNSCC26_data.RData"))
```

## Run comparison   

We run the pipeline that performs the classification of malignant and non-malignant cells in the two samples (Primary and Lymph Node) and compares the clonal profile of cancer cells inferred from the two samples, using 20 cores.

```{r echo=TRUE, message=FALSE, warning=FALSE}

library(SCEVAN)

results <- compareClonalStructure(count_mtx1 = count_mtx_prim, count_mtx2 = count_mtx_lymph, samp_1 = "HNSCC26_prim", samp_2 = "HNSCC26_lymph", par_cores = 20)
```

## Output

The pipeline returns in ***results*** a data frame containing for each cell its classification (tumor/normal), whether it has been used as a normal confident cell.

```{r echo=TRUE, message=FALSE, warning=FALSE}
head(results)
```

And creates an output folder containing segmentation output files and all the plots generated by the analysis:

```{r echo=TRUE, message=FALSE, warning=FALSE}
list.files(path = "./output", pattern = "HNSCC26")
```

### Heatmap classification of tumor cells (heatmap.png)

Heatmap of the Copy Number Alteration matrix with classification of non-malignant and malignant cells.

Primary
<img src="./output/HNSCC26_primheatmap.png" alt="heatmap" width="1280"/>
Lymph node
<img src="./output/HNSCC26_lymphheatmap.png" alt="heatmap" width="1280"/>

### Consensus plot (consensus.png)

Compact plot of the alterations present in each sample.

<img src="./output/HNSCC26_prim-vs-HNSCC26_lymphconsensus.png" alt="heatmap" width="1280"/>

### Copy number plot (CNline.png)

Copy number plot that highlighting specific alteration, shared alteration between samples.

<img src="./output/HNSCC26_prim-vs-HNSCC26_lymphplotCNline.png" alt="heatmap" width="720"/>

### OncoPrint-like plot (OncoHeat.png)

OncoPrint-like plot that highlighting specific alteration, shared alteration between samples.

<img src="./output/HNSCC26_prim-vs-HNSCC26_lymphOncoHeat.png" alt="heatmap" width="720"/>

